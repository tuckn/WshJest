var describe,test,expect,jest=jest||{};!function(){var _description,_skippedCounts,_passedCounts,_failedCounts,_expectedCounts,ANYTHING_OBJ={matching:"null/undefined"},_reTestName=function(){if(0<WScript.Arguments.length)for(var arg,matched,reTestPtn=new RegExp("^(-t|--testNamePattern)=(.+)$"),i=0,I=WScript.Arguments.length;i<I;i++){if(arg=String(WScript.Arguments(i)),reTestPtn.test(arg))return matched=arg.match(reTestPtn),new RegExp(matched[2]);if("-t"===arg||"--testNamePattern"===arg)return new RegExp(String(WScript.Arguments(i+1)))}}(),_protoTypeOf=(jest._protoTypeOf=function(val){return val===undefined?"undefined":null===val?"null":Object.prototype.toString.call(val).slice(8,-1)},jest._protoTypeOf),_toDir=(jest._toDir=function(val,indent){var i,I,p,newIndent="  "+(indent=indent||""),type=_protoTypeOf(val),r="";if("undefined"===type||"null"===type)r=type;else if(!0===val)r="true";else if(!1===val)r="false";else if(val===Infinity)r="Infinity";else if("unknown"==typeof val)r=val;else if("String"===type)r='"'+val+'"';else if("Number"===type)r=isNaN(val)?"NaN":String(val);else if("Object"===type){for(p in r="{\n",Object(val))r+=newIndent+p+": "+_toDir(val[p],newIndent)+",\n";r=r.replace(/,\n$/,"\n"),r+=indent+"}"}else if("Array"===type){for(r="[\n",i=0,I=val.length;i<I;i++)r+=newIndent+i+": "+_toDir(val[i],newIndent)+",\n";r=r.replace(/,\n$/,"\n"),r+=indent+"]"}else r="Error"===type?(r=(val.name?String(val.name):"Error")+": ",(r+="["+(val.number?String(val.number):"")+"] ")+(val.message||"")):String(val);return r},jest._toDir),Test=(jest._contains=function(collection,target){var typeObjA=_protoTypeOf(collection);if(target===ANYTHING_OBJ&&collection!==undefined&&null!==collection)return!0;if("String"===typeObjA)return-1!==collection.indexOf(target);if("Array"===typeObjA)for(var i=0,len=collection.length;i<len;i++){if(target===ANYTHING_OBJ&&collection[i]!==undefined&&null!==collection[i])return!0;if(collection[i]===target)return!0}return!1},jest._containsEqual=function(collection,target){var val;if("Array"===_protoTypeOf(collection))for(var i=0,len=collection.length;i<len;i++)if(val=collection[i],"Array"===_protoTypeOf(val)||"Object"===_protoTypeOf(val)){if(jest._equal(val,target))return!0}else{if(target===ANYTHING_OBJ&&val!==undefined&&null!==val)return!0;if(val===target)return!0}return!1},jest._equal=function(valA,valB){if(valB===ANYTHING_OBJ&&valA!==undefined&&null!==valA)return!0;if(valA===valB)return!0;var propNameA,propNameB,typeValA=_protoTypeOf(valA),typeValB=_protoTypeOf(valB);if("Array"===typeValA||"Array"===typeValB){if("Array"!==typeValA||"Array"!==typeValB)return!1;var lenA=valA.length,lenB=valB.length;if(lenA!==lenB)return!1;if(0===lenA&&0===lenB)return!0;for(var i=0;i<lenA;i++)if(!jest._equal(valA[i],valB[i]))return!1;return!0}if("Number"===typeValA||"Number"===typeValB)return"Number"===typeValA&&"Number"===typeValB&&(valA!=valA&&valB!=valB);if("String"===typeValA||"String"===typeValB)return"String"===typeValA&&"String"===typeValB&&valA===valB;if("Object"!==typeValA&&"Object"!==typeValB)return!1;if("Object"!==typeValA||"Object"!==typeValB)return!1;if(typeValA!==typeValB)return!1;for(propNameA in valA){if(!Object.prototype.hasOwnProperty.call(valB,propNameA))return!1;if(!jest._equal(valA[propNameA],valB[propNameA]))return!1}for(propNameB in valB)if(!Object.prototype.hasOwnProperty.call(valA,propNameB))return!1;return!0},jest._checkTypeIsNumber=function(functionName,varName,val){if("Number"!==_protoTypeOf(val))throw new Error(functionName+": "+varName+" value "+val+" is not a Number")},WScript.Echo(String(WScript.ScriptFullName)),describe=function(description,fn){_description=description,_failedCounts=_passedCounts=_skippedCounts=0,WScript.Echo("\n----------------------------\n"+description),fn();description="\nTests: ",fn=_skippedCounts+_passedCounts+_failedCounts;0!==_skippedCounts&&(description+=_skippedCounts+" skipped, "),0!==_passedCounts&&(description+=_passedCounts+" passed, "),WScript.Echo(description+fn+" total")},function(name,fn){if(!_reTestName||_reTestName.test(_description)||_reTestName.test(name)){var startTime,msec;_expectedCounts=0;try{startTime=new Date,fn(),msec=(new Date).getTime()-startTime.getTime(),WScript.Echo("  √ "+name+" ("+msec+"ms "+_expectedCounts+"exp)"),_passedCounts+=1}catch(e){msec=(new Date).getTime()-startTime.getTime(),WScript.Echo("  × "+name+" ("+msec+"ms "+(_expectedCounts-1)+"exp)"),WScript.Echo("      No."+_expectedCounts+" "+String(e.message)),_failedCounts+=1}}else _skippedCounts+=1}),Expect=((test=function(name,fn){return new Test(name,fn)}).skip=function(){_skippedCounts+=1},function(received){this.not={},this.toBe=function(expected){if(_expectedCounts+=1,received!==expected)throw new Error("Expected to be "+expected+", but "+_toDir(received))},this.not.toBe=function(expected){if(_expectedCounts+=1,received===expected)throw new Error("Expected not to be "+expected+", but "+_toDir(received))},this.toBeNaN=function(){if(_expectedCounts+=1,received==received)throw new Error},this.not.toBeNaN=function(){if(_expectedCounts+=1,received!=received)throw new Error},this.toBeGreaterThan=function(expected){_expectedCounts+=1;var FN="toBeGreaterThan";if(jest._checkTypeIsNumber(FN,"expected",expected),jest._checkTypeIsNumber(FN,"received",received),!(expected<received))throw new Error("Expected to be greater than "+expected+", but "+received)},this.toBeGreaterThanOrEqual=function(expected){_expectedCounts+=1;var FN="toBeGreaterThanOrEqual";if(jest._checkTypeIsNumber(FN,"expected",expected),jest._checkTypeIsNumber(FN,"received",received),!(expected<=received))throw new Error("Expected to be equal or greater than "+expected+", but "+received)},this.toBeLessThanOrEqual=function(expected){_expectedCounts+=1;var FN="toBeLessThanOrEqual";if(jest._checkTypeIsNumber(FN,"expected",expected),jest._checkTypeIsNumber(FN,"received",received),!(received<=expected))throw new Error("Expected to be equal or less than "+expected+", but "+received)},this.toBeLessThan=function(expected){_expectedCounts+=1;var FN="toBeLessThan";if(jest._checkTypeIsNumber(FN,"expected",expected),jest._checkTypeIsNumber(FN,"received",received),!(received<expected))throw new Error("Expected to be less than "+expected+", but "+received)},this.toBeNull=function(){if(_expectedCounts+=1,null!==received)throw new Error},this.not.toBeNull=function(){if(_expectedCounts+=1,null===received)throw new Error},this.toBeTruthy=function(){if(_expectedCounts+=1,1!=received)throw new Error},this.toBeFalsy=function(){if(_expectedCounts+=1,0!=received)throw new Error},this.toBeUndefined=function(){if(_expectedCounts+=1,received!==undefined)throw new Error("Expected to be undefined, But defined. "+_toDir(received))},this.toBeDefined=function(){if(_expectedCounts+=1,received===undefined)throw new Error("Expected not to be undefined, But undefined.")},this.toContain=function(item){if(_expectedCounts+=1,received===undefined||null===received)throw new Error("\nexpect(received).toContain(expected)\nMatcher error: received value must not be null or undefined\nReceived has value: "+_toDir(received));if(!jest._contains(received,item))throw new Error("Expected to contain "+_toDir(item)+" in "+_toDir(received)+". but is not contained.")},this.not.toContain=function(item){if(_expectedCounts+=1,received===undefined||null===received)throw new Error("\nexpect(received).toContain(expected)\nMatcher error: received value must not be null or undefined\nReceived has value: "+_toDir(received));if(jest._contains(received,item))throw new Error("Expected to not contain "+_toDir(item)+" in "+_toDir(received)+". but is contained.")},this.toContainEqual=function(item){if(_expectedCounts+=1,!jest._containsEqual(received,item))throw new Error("Expected to contain "+_toDir(item)+" in "+_toDir(received)+". but is not contained.")},this.not.toContainEqual=function(item){if(_expectedCounts+=1,jest._containsEqual(received,item))throw new Error("Expected to not contain "+_toDir(item)+" in "+_toDir(received)+". but is contained.")},this.toEqual=function(expected){if(_expectedCounts+=1,!jest._equal(received,expected))throw new Error("Expected to be "+_toDir(expected)+", but "+_toDir(received))},this.not.toEqual=function(expected){if(_expectedCounts+=1,jest._equal(received,expected))throw new Error("Expected to be not "+_toDir(expected)+", but "+_toDir(received))},this.toHaveLength=function(expected){_expectedCounts+=1;var len=received.length;if(len!==expected)throw new Error("Expected to have "+expected+" length, but "+len)},this.not.toHaveLength=function(expected){_expectedCounts+=1;var len=received.length;if(len===expected)throw new Error("Expected to not have "+expected+" length, but "+len)},this.toMatch=function(regexpObj){if(_expectedCounts+=1,!regexpObj.test(received))throw new Error("Expected to be "+_toDir(regexpObj)+", but "+_toDir(received))},this.not.toMatch=function(regexpObj){if(_expectedCounts+=1,regexpObj.test(received))throw new Error("Expected to be not "+_toDir(regexpObj)+", but "+_toDir(received))},this.objectContaining=function(expected){_expectedCounts+=1},this.not.objectContaining=function(expected){_expectedCounts+=1},this.toThrowError=function(){_expectedCounts+=1;var errMsg="Expected throwing a error, but not did";try{throw received(),new Error(errMsg)}catch(e){if(errMsg===e.message)throw new Error(errMsg)}},this.toThrow=function(){_expectedCounts+=1,this.toThrowError()}});(expect=function(received){return new Expect(received)}).anything=function(){return ANYTHING_OBJ}}();
